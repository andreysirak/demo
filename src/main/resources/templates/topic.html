<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="ISO-8859-1">
<title>Topic Discussion</title>
</head>
<script type="text/javascript">	
	function toggle_visibility(id) {
	var e = document.getElementById(id);
	if(e.style.display == 'block')
	e.style.display = 'none';
	else
	e.style.display = 'block';
	};
	</script>

	<script type="text/javascript">	
	 function checkForm()
	 {
		  var x = document.forms["comment_form"]["comment_field"].value;
		  if (x == "") {
		    alert("Comment must be filled out");
		    return false;
		  }
		}
	</script>
	
	
<body>
<body>
	<a th:href="@{/}">Back Home</a>
	<br />
	<br />
	<a th:utext="${topic.content}">...</a>
	<hr />
	<div>
		<div th:each="comment : ${listOfFoundComments}"><a th:utext="'<'+${#dates.format(comment.timePlaced, 'dd-MMM-yyyy hh:mm')}+'>  '+${comment.message}"> </a>
			<a href="#" th:attr="onclick='toggle_visibility('+${comment.id}+');'">..reply</a> 
			<div th:each="reply : ${comment.listOfReplies}"><a  th:utext="'<'+${#dates.format(reply.timePlaced, 'dd-MMM-yyyy hh:mm')}+'>  '+${reply.message}" style="margin-left: 20px"> </a><br />
			</div>
			<!-- reply text field -->
			<div th:id="${comment.id}" style="display: none">
				<form th:action="@{/topic/{topicId}/reply(topicId=${topic.id},commentId=${comment.id})}" th:object="${reply}" method="POST" onsubmit="return checkForm(this);">
				<input type="text" size="35" th:field="*{message}"/> <input type="submit" value="Add" />				
				</form>
			</div>
		</div>
	</div>
	<br />
	<br />
	<form name="comment_form" th:action="@{/topic/{topicId}/addComment(topicId=${topic.id})}"th:object="${comment}" method="POST" onsubmit="return checkForm();" >
	Comment:<input type="text" name="comment_field" th:field="*{message}" size="35" />
	<input  type="submit" value="Add" />	
	</form>



</body>

</body>
</html>